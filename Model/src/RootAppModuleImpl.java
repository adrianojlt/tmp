package ora.pt.cons.igif.sics;


import java.sql.PreparedStatement;
import java.sql.ResultSet;
import ora.pt.cons.igif.sics.InformacaoUtilizadorImpl;
import ora.pt.cons.igif.sics.OpcoesMenuUtilizadorImpl;
import ora.pt.cons.igif.sics.utentes.DetalheUtenteImpl;
import ora.pt.cons.igif.sics.utentes.UtentesPesquisaImpl;
import oracle.jbo.server.ApplicationModuleImpl;

import org.apache.log4j.Logger;
import org.apache.log4j.PropertyConfigurator;

// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class RootAppModuleImpl extends ApplicationModuleImpl {

    private static Logger log = Logger.getLogger(RootAppModuleImpl.class);
    
    /**This is the default constructor (do not remove)
     */
    public RootAppModuleImpl() {
        PropertyConfigurator.configure(System.getProperty("sics.property.log4j.fileConfiguration"));
        log.info("RootAppModuleImpl instanciado");
    }

    /**Sample main for debugging Business Components code using the tester.
     */
    public static void main(String[] args) {
        launchTester("ora.pt.cons.igif.sics.doc", /* package name */
      "RootAppModuleLocal" /* Configuration Name */);
    }

    /**Container's getter for UtentesPesquisa
     */
    public UtentesPesquisaImpl getUtentesPesquisa() {
        return (UtentesPesquisaImpl)findViewObject("UtentesPesquisa");
    }

    /**Container's getter for InformacaoUtilizador
     */
    public InformacaoUtilizadorImpl getInformacaoUtilizador() {
        return (InformacaoUtilizadorImpl)findViewObject("InformacaoUtilizador");
    }

    /**Container's getter for OpcoesMenuUtilizador
     */
    public OpcoesMenuUtilizadorImpl getOpcoesMenuUtilizador() {
        return (OpcoesMenuUtilizadorImpl)findViewObject("OpcoesMenuUtilizador");
    }
    
    /**Container's getter for InformacaoUtente
     */
    public InformacaoUtenteImpl getInformacaoUtente() {
        return (InformacaoUtenteImpl)findViewObject("InformacaoUtente");
    }


    /**Container's getter for ReceitasModule
     */
    public ApplicationModuleImpl getReceitasModule() {
        return (ApplicationModuleImpl)findApplicationModule("ReceitasModule");
    }

    /**Container's getter for ModulosSuporteModule
     */
    public ApplicationModuleImpl getModulosSuporteModule() {
        return (ApplicationModuleImpl)findApplicationModule("ModulosSuporteModule");
    }
    
    public String getCSId(String instCod, String instTipo) {
        PreparedStatement stmt = null;
        String sqlQuery = null;
        ResultSet rs = null;
        String retVal = null;
        try{
            sqlQuery = "SELECT SEN.ID CS_ID " +
                       "  FROM SYS_ENTIDADES SEN " +
                       ",      SYS_COD_GENERICOS COD " +
                       " WHERE SEN.CODIGO = ? " +
                       "   AND SEN.SYS_SUBTIPO_ENTIDADES_ID = COD.ID " +
                       "   AND COD.CODIGO = ? " +
                       "   AND SEN.ACTIVO = 'S' ";
            stmt = this.getDBTransaction().createPreparedStatement(sqlQuery,0);           
            stmt.setString(1,instCod);
            stmt.setString(2,instTipo);
            rs = stmt.executeQuery();
            if(rs.next()){
                retVal = rs.getString("CS_ID");
            }
        } catch(Throwable t){
          log.error(t);
          return null; // Error
        }
        return retVal; // Success
    }

    /**Container's getter for ListaParametros
     */
    public ListaParametrosImpl getListaParametros() {
        return (ListaParametrosImpl)findViewObject("ListaParametros");
    }

    /**Container's getter for IdentificacaoUtenteModule
     */
    public ApplicationModuleImpl getIdentificacaoUtenteModule() {
        return (ApplicationModuleImpl)findApplicationModule("IdentificacaoUtenteModule");
    }

    /**Container's getter for CartaoCidadaoModule1
     */
    public ApplicationModuleImpl getCartaoCidadaoModule1() {
        return (ApplicationModuleImpl)findApplicationModule("CartaoCidadaoModule1");
    }

    /**Container's getter for CartaoCidadaoModule
     */
    public ApplicationModuleImpl getCartaoCidadaoModule() {
        return (ApplicationModuleImpl)findApplicationModule("CartaoCidadaoModule");
    }


    public void detalheUtenteAddWhereClause(String idUtente) throws Exception {
        log.debug("entrou");
        try{
            ViewObjectImpl vo = (ViewObjectImpl)this.getDetalheUtente();
            vo.clearWhereState();
            if (idUtente == null) {
                idUtente = new String("");
            }
            if (idUtente.length() > 0 ) {
                    String whereClause = new String(" idi_id = ").concat(idUtente);
                    vo.setNamedWhereClauseParam("idUtente", idUtente);
                    vo.addWhereClause(whereClause);
                    vo.setMaxFetchSize(-1);
                    vo.clearCache();
                    vo.executeQuery();
            } else {
                vo.setMaxFetchSize(0);
            }
        } catch(Exception t){
          log.error(t);
          throw t;
        }
        log.debug("saiu");
    }

    /**Container's getter for DetalheUtente
     */
    public DetalheUtenteImpl getDetalheUtente() {
        return (DetalheUtenteImpl)findViewObject("DetalheUtente");
    }

    /**Container's getter for BaixasModule1
     */
    public ApplicationModuleImpl getBaixasModule1() {
        return (ApplicationModuleImpl)findApplicationModule("BaixasModule1");
    }

    /**Container's getter for IdentificacaoUtenteModule1
     */
    public ApplicationModuleImpl getIdentificacaoUtenteModule1() {
        return (ApplicationModuleImpl)findApplicationModule("IdentificacaoUtenteModule1");
    }
}
